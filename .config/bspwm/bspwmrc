#!/usr/bin/bash

# Utility for checking if a program exist
_check() {
	command -v "$1" > /dev/null
}


# query xresources for value of color
xresource() {
    xrdb -query | grep -E "^(bspwm|\*)\.$1:" | sed -r "s/^[^:]+:\s+//" | tail -n 1
}

reset_polybar() {
	sh $HOME/.config/polybar/run.sh &
}

# Set the layout script generated by arandr if it exist
layout_script=$HOME/.screenlayout/layout.sh
[ -f $layout_script ] && sh $layout_script

# Start the keymapper
pgrep -x sxhkd > /dev/null || sxhkd &

# Reset background if we have set if before
[ -f "$HOME/.fehbg" ] && $HOME/.fehbg

# Reload our color scheme
_check wal && wal -R

# Setup the workspaces for the monitor
bspc monitor -d I II III IV V VI VII VIII IX X
bspc config border_width         2
bspc config window_gap           5

bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true

bspc config top_padding 		 0
bspc config bottom_padding 		 20

bspc rule -a Gimp desktop='^8' state=floating follow=on
bspc rule -a Brave desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off

# Blue
bspc config focused_border_color $(xresource color4)
# Black
bspc config normal_border_color $(xresource color0)
bspc config active_border_color $(xresource color0)


# Launch polybar on all monitors
_check polybar && reset_polybar
